# АРМ "Помощник библиотекаря"


![Banner](https://www.wellesleyfreelibrary.org/wp-content/uploads/2015/08/computeruse.jpg)

![badge](https://img.shields.io/badge/WEB%20development-0052FF?style=flat-square&Color=white)
![badge](https://img.shields.io/badge/Python-FFD43B?style=flat-square&logo=python&logoColor=blue)
![badge](https://img.shields.io/badge/MySQL-316192?style=flat-square&logo=mysql&logoColor=white)


АРМ "Помощник библиотекаря" - это приложение, служащее для учета имеющихся в библиотеке книг. Оно состоит из двух частей: непосредственно базы данных и приложения для пользователя.

## Содержание

- [Общие данные](#general_info)
- [Описание функциональности и процессов работы АРМ](#app_desc)
- [Описание кода](#code_desc)
- [Вклад](#contributors)

## <a name="general_info"></a> Общие данные

### Постановка исходной задачи

В рамках тестового задания необходимо разработать приложение АРМ "Помощник библиотекаря", которое должно позволять выяснять:
1. Какие книги имеются в библиотеке;
2. Кто и когда брал книгу;
3. Где и у кого книга находится в настоящее время.

Приложение должно состоять из двух частей: база данных и приложение для пользователя.
**База данных** должна содержать информацию об авторах, книгах, читателях и фактах взятия-возврата книг. Она должна быть составлена таким образом, чтобы можно было получить информацию о любой книге на любой момент времени.
**Программа** должна подключаться к базе данных и добавлять в нее информацию или выводить отчеты.

В начале работы пользователю необходимо предоставить выбор:
* Добавить/удалить/изменить книгу;
* Добавить/удалить/изменить пользователя (читателя);
* Добавить факт взятия/возврата книги;

Также должен быть доступен просмотр следующих отчетов:
* Сколько книг есть в библиотеке, сколько читателей;
* Сколько книг брал каждый читатель за все время;
* Сколько книг находится на руках у каждого читателя в настоящий момент времени;
* Дата последнего посещения читателем библиотеки;
* Самый читаемый автор;
* Самые предпочитаемые жанры по убыванию;
* Любимый жанр каждого читателя.

При выполнении задания рекомендуется:
1. Не использовать ORM-фреймворки;
2. Базу данных реализовать на основе одной из следующих СУБД: PostgeSQL, MySQL, SQLite, MS Access, MS SQL Server или другой реляционной СУБД;
3. Программу реализовать на основе языков Java или Python (предпочтительнее);

Результат выполнения задачи:
* Скрипт на языке SQL, содержащий базу данных;
* Скрипт на языке SQL, заполняющий базу данных информацией;
* Исходный код разработанного приложения;
* Инструкция по запуску.


### Основной стек

* Python 3.9
* MySQL 8.0.36

## <a name="app_desc"></a> Описание функциональности и процессов работы АРМ
### <a name="app_components"></a> Составные части приложения
Для корректной работы АРМ "Помощник библиотекаря" были созданы и добавлены в текущий репозиторий следующие файлы:
1. Create DB library.sql - файл, содержащий скрипт создания базы данных (описывает сущности и их атрибуты);
2. Data for DB.sql - файл, содержащий скрипт для заполнения базы данных;
3. Selection_scripts.sql - файл, содержащий скрипты для осуществления различных выборок;
4. **Prog_console.py** - файл, содержащий исходный код консольного приложения на языке Python.

### <a name="project deployment"></a> Развертывание приложения
Перед началом работы с приложением АРМ "Помощник библиотекаря" необходимо подготовить среду:
1. Загрузить файлы из данного удаленного репозитория на свой локальный репозиторий;
2. Проверить, установлен ли инструмент визуального проектирования баз данных [MySQL Workbench](https://dev.mysql.com/downloads/workbench/);
3. Проверить, установлена ли любая система управления базами данных (например, [DBeaver](https://dbeaver.io/));
4. Проверить, установлена ли IDE для работы с Python (VSCode, PyCharm и др.).


Для развертывания приложения и дальнейшей работы с ним необходимо выполнить следующие действия:
1. Убедиться, что у MySQL Workbench есть локальное подключение (заполнены данные по хосту, порту, имени пользователя и паролю). При отсутствии его можно создать, заполнив отмеченные на картинке поля;

<p align="center">
  <img width="600" src="https://github.com/Stoamper/ITBuro_Test/assets/87001138/1ae84b7b-61c0-403a-a452-55a6c6ab2f01">
</p>

2. Убедиться, что в DBeaver есть локальное подключение (заполнены данные по хосту, порту, имени пользователя и паролю). При отсутствии его можно создать, заполнив отмеченные на картинке поля (аналогично п.1);

<p align="center">
  <img width="600" src="https://github.com/Stoamper/ITBuro_Test/assets/87001138/494c356e-653e-419e-9b9d-dbd9285849d4">
</p>

В случае успешного соединения у значка localhost появится галочка

<p align="center">
  <img width="300" src="https://github.com/Stoamper/ITBuro_Test/assets/87001138/fb71fd3f-7e5c-4429-b6d5-42dc9febbb9e">
</p>

3. Для создания базы данных "libraby" выполняем SQL скрипт, находящийся в файле "Create DB library.sql". Обновляем базу данных.
4. Для заполнения базы данных выполняем скрипт, находящийся в файле "Data for DB.sql". Обновляем базу данных.
5. В файле **Prog_console.py** необходимо настроить подключение к базе данных. Для этого указываем данные по хосту, порту, пользователю и паролю.

<p align="center">
  <img width="400" src="https://github.com/Stoamper/ITBuro_Test/assets/87001138/87d75c26-f3c0-4b3e-bdc4-776bf516fa4e">
</p>

После выполнения всех указанных шагов приложение готово к работе.


### Взаимодействие пользователя с приложением

После подготовки окружения можно приступить к работе. 

Приложение АРМ "Помощник библиотекаря" является консольным. Это значит, что ввод команд и вывод отчетов осуществляется непосредственно в консоль IDE.

Для выполнения команды необходимо в консоли набрать **python Prog_console.py** или **py Prog_console.py** и далее через пробел ввести интересующую команду. 
<p align="center">
  <img width="300" src="https://github.com/Stoamper/ITBuro_Test/assets/87001138/292d1da8-3c20-4287-80a0-26a6605c59ed">
</p>

Список команд с описанием их работы приведен в таблице ниже.
| Команда | Описание | Действия |
| ------- | ------- | ------- | 
| *Insert_book* | Добавление новой книги в базу | Будет предложено последовательно ввести название книги, id автора, жанр, ISBN, год публикации |
| *Delete_book* | Удаление книги из базы | Будет предложено ввести id книги, которую следует удалить |
| *Update_book* | Изменить информацию о книге | Будет предложено ввести id изменяемой книги, названия, id автора, жанра, ISBN, года публикации |
| *Insert_reader* | Добавить нового читателя в базу | Будет предложено последовательно ввести фамилию, имя, отчество, телефон и адрес читателя |
| *Delete_reader* | Удалить читателя из базы | Будет предложено ввести id читателя, которого следует удалить |
| *Update_reader* | Изменить информацию о читателе | Будет предложено ввести id изменяемого читателя, его фамилии, имени, отчества, телефона и адреса |
| *Insert_book_issuance* | Добавить в базу новую выданную книгу | Будет предложено ввести id книги, статуса выдачи, id читателя, даты выдачи, даты возврата, id библиотекаря |
| *Update_book_issuance* | Изменить информацию о выданной книге | Будет предложено ввести id строки выдачи, статуса выдачи и даты возврата |
| *Authors* | Показать общее количество авторов книг в библиотеке | Выводится общая цифра |
| *Books* | Показать общее количество книг в библиотеке | Выводится общая цифра |
| *Readers* | Показать всех читателей | Выводится общая цифра |
| *Books_taken* | Показать сколько книг брал каждый читатель за все время | Построчно выводится сколько книг брал каждый читатель за все время |
| *Books_readers* | Показать сколько книг находится на руках у каждого читателя в настоящее время | Построчно выводится количество книг на руках у каждого читателя в настоящее время |
| *Last_visit* | Показать дату последнего посещения библиотеки у каждого читателя | Построчно выводится дата последнего посещения читателем библиотеки |
| *Most_read_author* | Показать самого читаемого автора | Выводится фамилия самого читаемого автора и общее количество его книг, которые брали читатели |
| *Most_read_genre* | Показать самые предпочитаемые читателями жанры по убыванию | Выводятся все жанры с указанием количества книг в порядке убывания |
| *Favorite_genre_readers* | Показать любимый жанр каждого читателя | Выводятся фамилии читателей и их любимые жанры |
| *All_books* | Показать все книги, имеющиеся в библиотеке | Выводятся все имеющиеся книги с указанием названия, автора и жанра |
| *Book_issuance_info* | Показать историю выдачи по конкретной книге | После ввода id интересующей книги выводится вся история ее выдачи (название, статус, id читателя, дата выдачи и дата возврата) |
| *Current_book_status* | Показать где и у кого находится книга в настоящее время | После ввода id интересующей книги выводится ее текущее состояние (название, статус, id читателя, дата выдачи и дата возврата) |
| *Not_returned_books* | Вывести отчет в формате .txt о книгах, не вернутых вовремя | Создается файл Not_returned_books_report.txt, в котором размещается информация о книгах, которые не были вернуты вовремя (содержит id книги, название, фамилию читателя, дату возврата) |

 
## <a name="code_desc"></a> Описание кода

Как было сказано [выше](#app_components) приложение состоит из SQL-скриптов Create DB library, Data for DB, Selection_scripts.sql и Python-файла **Prog_console**

Рассмотрим более подробно каждый из них.

### <a name="create_db"></a> Create DB library (создание БД)

Файл Create DB library.sql содержит данные по созданию следующих таблиц (сущностей) базы данных library:
1. **librarians**
Таблица содержит информацию обо всех библиотекарях. Атрибуты, их типы и описание представлены в таблице ниже.

| Атрибут | Тип | Описание | Особенности |
| ------- | ------- | ------- | ------- | 
| id | serial | id библиотекаря | Является первичным ключом  |
| lastname | VARCHAR(100) | Фамилия библиотекаря |  |
| firstname | VARCHAR(100) | Имя библиотекаря |  |
| patronymic | VARCHAR(100) | Отчество библиотекаря |  |  

2. **readers**
Таблица содержит информацию обо всех читателях. Атрибуты, их типы и описание представлены в таблице ниже.

| Атрибут | Тип | Описание | Особенности |
| ------- | ------- | ------- | ------- | 
| id | serial | id читателя | Является первичным ключом  |
| lastname | VARCHAR(100) | Фамилия читателя |  |
| firstname | VARCHAR(100) | Имя читателя |  |
| patronymic | VARCHAR(100) | Отчество читателя |  |  
| phone_number | VARCHAR(20) | Телефон читателя | Уникальное поле (не допускаются повторы с другими) | 
| address | VARCHAR(200) | Адрес читателя | Уникальное поле (не допускаются повторы с другими) | 


3. **authors**
Таблица содержит информацию обо всех авторах. Атрибуты, их типы и описание представлены в таблице ниже.

| Атрибут | Тип | Описание | Особенности |
| ------- | ------- | ------- | ------- | 
| id | serial | id автора | Является первичным ключом  |
| lastname | VARCHAR(100) | Фамилия автора |  |
| firstname | VARCHAR(100) | Имя автора |  |
| patronymic | VARCHAR(100) | Отчество автора |  |


4. **books**
Таблица содержит информацию обо всех книгах в библиотеке. Атрибуты, их типы и описание представлены в таблице ниже.

| Атрибут | Тип | Описание | Особенности |
| ------- | ------- | ------- | ------- | 
| id | serial | id книги | Является первичным ключом  |
| title | VARCHAR(100) | Название книги |  |
| author_id | BIGINT unsigned NOT NULL | id автора | Является внешним ключем для таблицы authors(id), ON UPDATE CASCADE ON DELETE CASCADE |
| genre | ENUM | Жанр книги | Выбирается из списка значений |
| isbn | VARCHAR(100) | ISBN книги |  |
| publishing_year | VARCHAR(100) | Год публикации |  |


5. **book_issuance**
Таблица содержит информацию о выдаче книг читателям. Атрибуты, их типы и описание представлены в таблице ниже.

| Атрибут | Тип | Описание | Особенности |
| ------- | ------- | ------- | ------- | 
| id | serial | id выдачи | Является первичным ключом  |
| book_id | BIGINT unsigned NOT NULL | id книги | Является внешним ключем для таблицы books(id), ON UPDATE CASCADE ON DELETE CASCADE |
| issuance_status | ENUM | Статус выдачи (в библиотеке, выдана) | Выбирается из списка значений |
| reader_id | BIGINT unsigned NOT NULL | id читателя | Является внешним ключем для таблицы readers(id), ON UPDATE CASCADE ON DELETE CASCADE |
| date_of_issue | DATE | Дата выдачи на руки |  |
| date_of_return | DATE | Дата возврата |  |
| librarian_id | BIGINT unsigned NOT NULL | id библиотекаря | Является внешним ключем для таблицы librarians(id), ON UPDATE CASCADE ON DELETE CASCADE |


Диаграмма базы данных представлена на рисунке ниже.

<p align="center">
  <img width="700" src="https://github.com/Stoamper/ITBuro_Test/assets/87001138/644c01e1-421a-4a54-a619-0fe2e55b2510">
</p>

Между сущностями установлены следующие связи:
1) **authors-books**: 1:M (один ко многим). Один автор может иметь множество книг.
2) **books-book issuance**: 1:М




### <a name="fill_db"></a> Data for DB (наполнение БД)


### <a name="selection_scripts"></a> Selection_scripts (выборка данных)


### <a name="prog_console"></a> Описание python (консольное приложение, как работает через консоль)



Как взаимодействует python и sql

### <a name="improvements"></a> Дальнейшие возможности улучшения приложения
1. Валидаторы;
2. GUI;
3. Многопользовательское;
4. ORM;
5. Удаление - не удалять из таблицы, а ставить атрибут is_deleted



## <a name="contributors"></a> Вклад

Этот проект существует благодаря всем, кто вносит вклад:\
[Роман Т.](https://gitlab.com/Stoamper)


